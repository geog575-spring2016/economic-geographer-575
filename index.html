<html>
<head>
    <meta charset='utf-8' />
    <title>Final Project 575</title>

    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <!-- LINK SIMPLE STATISTICS -->
    <script src="lib/simple_statistics.js" charset="utf-8"></script>

    <!-- LINK D3 & ASSOCIATED -->
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="https://d3js.org/d3-queue.v2.min.js"></script>

    <!-- LINK jQUERY & jQUERYUI -->
    <link rel="stylesheet" href="lib/jquery-ui-1.11.4.custom/jquery-ui.min.css">
	<script src="lib/jquery-ui-1.11.4.custom/external/jquery/jquery.js"></script>
	<script src="lib/jquery-ui-1.11.4.custom/jquery-ui.min.js"></script>

    <!-- LINK FONT AWESOME -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

    <!-- LINK MAPBOX -->
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.16.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.16.0/mapbox-gl.css' rel='stylesheet' />
    <!-- /LINK MAPBOX -->
    <script src='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.css' rel='stylesheet' />
    <!-- Link custom css -->
    <link href="css/style.css" rel="stylesheet" />
    <link href="css/scatterPlot.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Raleway:800,200,500|Noticia+Text:400,700,400italic' rel='stylesheet' type='text/css'>

</head>
<body>


<div id="splash01" style="position:absolute; height:100%; width:100%; background: rgba(0,0,0,0.25); z-index:100; transform:translate(0%);">
	<div style="width:50%; background:white;margin-left:25%; margin-right:25%; border-radius:20px;">
		<h1 style="text-align:center;">United States County
        </br>Housing Data Explorer</h1>
        <p>Many variables contribute to differences in the value of houses across the country. Select two variables below to explore some of those variables both in the scatterplot and bivariate choropleth. Upload your own single attribute dataset if you have another variable you'd like to include.</p>
		<button style="cursor:pointer;" onclick="moveSplashPage()">Click here for map</button>
	</div>
</div>

<div id="splash02" style="position:absolute; height:100%; width:100%; background: rgba(0,0,0,0.25); z-index:99; transform:translate(0%);"></div>

<div id="load01" style="position:absolute; height:100%; width:100%; background: rgba(0,0,0,0.25); z-index:1; transform: translate(150%);">
	<div class="container">
  		<div class="ball"></div>
  		<div class="ball"></div>
  		<div class="ball"></div>
  		<div class="ball"></div>
  		<div class="ball"></div>
  		<div class="ball"></div>
  		<div class="ball"></div>
	</div>
</div>
<!-- mapbox gl map -->


<div id='map' style="position:absolute; width:100%; height:100%; background:black;"></div>



<!-- this should be the timeseries control -->
<div id="titleSidebar">
    <div id="importUserData">
        <p>Upload your own single attribute dataset using the dataset template available below </p>
        <a href="/data/template.csv" download><button type="button">Download Dataset Template</button></a>
        <input type="file" id='Uploaded_User_Dataset' accept='.csv'></input>
    </div></br>

</div>

<!-- timeseries control -->
<div id="slider"></div>


<div id="dropdownContainer">
    <select id="yAxisDropdown">
        <option value="Median_Home_Value">Median Home Value</option>
        <option value="Median_Household_Income" selected>Median Household Income</option>
        <option value="Unemployment_Rate">Unemployment Rate</option>
        <option value="Median_Monthly_Ownership_Costs">Median Monthly Ownership Costs</option>
         <option value="Housing_Age">Housing Age</option>
         <option value="Uploaded_User_Dataset">Uploaded User Dataset</option>
    </select>
    <select id="xAxisDropdown">
        <option value="Median_Home_Value" selected>Median Home Value</option>
        <option value="Median_Household_Income">Median Household Income</option>
        <option value="Unemployment_Rate">Unemployment Rate</option>
        <option value="Median_Monthly_Ownership_Costs">Median Monthly Ownership Costs</option>
        <option value="FIPS">County (Single Variate)</option>
    </select>
</div>

<!-- Link custom js script -->
<script src="js/loadData.js"></script>
<script src="js/buildVisualizations.js"></script>
<script src="js/buildScatterPlot.js"></script>
<script src="js/buildChoropleth.js"></script>
<script src="js/buildControls.js"></script>

<script>
	var mapControl = false;
	var widgetControl = false;
	var stateControl = false;
	var fullCountyControl = true;

	function moveSplashPage() {
		document.getElementById("splash01").style.transform = "translate(150%)";
		document.getElementById("splash02").style.transform = "translate(-150%)";
	};

	function toggleMap() {
		// so filterDots function takes in an arrray of fips ids, so to filter map on click
		// we just need to pass the fips id's from the state that is clicked into this function
        //filterDots(["55001", "55003"]);

		if (mapControl == false) {
			document.getElementById("map2").style.transform = "translate(0%)";
			mapControl = true;
			return mapControl;
		} else if (mapControl == true) {
			document.getElementById("map2").style.transform = "translate(100%)";
			mapControl = false;
			return mapControl;
		}
	};

	function toggleWidget() {
		if (widgetControl == false) {
			widgetControl = true;
			document.getElementById("importUserData").style.transform = "translate(0%)";
			return widgetControl;
		} else if (widgetControl == true) {
			widgetControl = false;
			document.getElementById("importUserData").style.transform = "translate(200%)";
			return widgetControl;
		}
	};

	function chooseByDrag() {
		startLoading();
		loadingTimer = setTimeout(stopLoading, 5000); //barbaric I know
		fullCountyControl = false;

		map.setFilter("counties-highlighted-A3", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-B3", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-C3", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-A2", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-B2", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-C2", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-A1", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-B1", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-C1", ["==", "STATE_NAME", "Alaska"]);

    	try {
			map.removeLayer("statesProper");
    		map.removeLayer("route-hover");
    	}
    	catch(err) {
    		stateControl = false;
    		return stateControl;
    	}

    	stateControl = false;
    	return stateControl;
    };

	function chooseByState() {
		startLoading();
		loadingTimer = setTimeout(stopLoading, 5000); //barbaric I know
		//map.removeLayer("countiesAttribute");
		fullCountyControl = false;
		stateControl = true;


		map.setFilter("counties-highlighted-A3", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-B3", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-C3", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-A2", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-B2", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-C2", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-A1", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-B1", ["==", "STATE_NAME", "Alaska"]);
    	map.setFilter("counties-highlighted-C1", ["==", "STATE_NAME", "Alaska"]);

    	/*
    	map.removeLayer("counties-highlighted-A3");
    	map.removeLayer("counties-highlighted-B3");
    	map.removeLayer("counties-highlighted-C3");
    	map.removeLayer("counties-highlighted-A2");
    	map.removeLayer("counties-highlighted-B2");
    	map.removeLayer("counties-highlighted-C2");
    	map.removeLayer("counties-highlighted-A1");
    	map.removeLayer("counties-highlighted-B1");
    	map.removeLayer("counties-highlighted-C1");
    	*/
			map.addLayer({
        		"id": "route-hover",
        		"type": "fill",
        		"source": "statesProper",
        		"layout": {},
        		"paint": {
            		"fill-color": "#627BC1",
            		"fill-opacity": 1
        		},
        		"filter": ["==", "NAME", ""]
    		}, "counties-highlighted-A1");

			map.addLayer ({
    			"id": "statesProper",
				"type": "fill",
    			"source": "statesProper",
    			"source-layer": "original",
    			'layout': {
            		'visibility': 'visible'
				},
    			"paint": {
    				"fill-outline-color": "black",
    				"fill-color": "white"
    			}
    		},"route-hover");
    		return stateControl;
	};

	function fullCounty() {
		startLoading();
		loadingTimer = setTimeout(stopLoading, 5000); //barbaric I know
		fullCountyControl = true;

		choropleth();
	};

	function startLoading() {
		document.getElementById("load01").style.transform = "translate(0%)";
	};

	function stopLoading() {
		document.getElementById("load01").style.transform = "translate(150%)";
	}

	function highlightPlayButton(x) {
		if (hoverAnimationControl == false) {
			document.getElementById(x).style.background = "#E8E57D";
			document.getElementById(x).style.color = "black";
		} else {
			return;
		}
	};

	function resetPlayButton(x) {
		if (hoverAnimationControl == false) {
			document.getElementById(x).style.background = "";
			document.getElementById(x).style.color = "";
		} else {
			return;
		}
	};

	function highlightRepick(x) {
		document.getElementById(x).style.background = "#E8E57D";
		document.getElementById(x).style.color = "black";
	};

	function resetRepick(x) {
		document.getElementById(x).style.background = "";
		document.getElementById(x).style.color = "";
	};

</script>

</body>


</html>
